<!DOCTYPE HTML>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="icon" href="images/favicon.png"/>
	<link href="https://fonts.googleapis.com/css?family=Montserrat:200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet"> 
  <title>Jasmine's Store Login</title>
		<!--custom css, themevault.net-->
		<link href="css/timepiece/bootstrap.min.css" rel="stylesheet" type="text/css" />
		<link href="fonts/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
		<link href="css/timepiece/style.css" rel="stylesheet" type="text/css" />
		<link href="css/timepiece/responsive.css" rel="stylesheet" type="text/css" />
		<!--js --->
		<script src="templatejs/jquery.min.js" type="text/javascript"></script>
		<script src="templatejs/bootstrap.min.js" type="text/javascript"></script>
		<script src="templatejs/custom.js" type="text/javascript"></script>
  <script>
    //Get parameters of quantities submitted from the URL
    window.onload = function() {
      let params = (new URL(document.location)).searchParams;
      document.getElementById("input-qstr").value = params; // get the query string which has the form data
        
        //Split params into quantities and errors
        let quantities = [];
        let errors = []
        let qtyStr = '';
        
        //THIS IS CREATED with assistance from Chat gpt 
        //Separate each key, quantity, and error and separate it one by one
        params.forEach((value, key) => {
          if (key.startsWith('quantity') || key === 'purchase_submit') {
            if (key === 'purchase_submit') {
              qtyStr += `${key}=${value}&`;
            } else {
              quantities.push(`${key}=${value}`);
            }
          } else if (key.startsWith('error')) {
            errors.push(value);
          } 
        });

        console.log(errors);

        if (errors.length > 0) {
          for (let i in errors) {
            errorMsg = errors[i];
            document.getElementById('errorsbox').innerHTML += errorMsg + " ";
            document.getElementById('errorsbox').style.color = "red";
          }
        }
          //rebuild quantity string
          qtyStr += quantities.join("&");
          document.getElementById('input-qstr').value = qtyStr;

					//append to href for register
					document.getElementById("registerLink").href = "/register.html" + "?" + qtyStr; 
			}
  </script>
</head>
<body>
  <!--Code taken from themevault https://www.themevault.net/timecenter-watch-ecommerce-web-template#-->
  <!--Slightly modified for assignemnt 2 use, copied up to line 78-->
  <div id="content" class="col-sm-9">
    <div class="row">
      <div class="col-sm-6">
        <div class="well">
          <div class="heading-text">
            <i class="fa fa-file-text-o"></i>
            <div class="extra-wrap">
              <h3>New Customer</h3>
              <strong>Register Account</strong>
              <hr />
            </div>
          </div>
          <p>By creating an account you will be able to shop faster, be up to date on an order's status, and keep track of the orders you have previously made.</p>
          <!--Create A Href-->
          <button type="button" class="btn btn-primary"><a href="/register.html" id="registerLink" style="color: white; font-weight: bold">Register for an Account</a></button>
        </div>
      </div>
      <div class="col-sm-6">
        <div class="well">
          <div class="heading-text">
            <h3>Returning Customer</h3>
            <strong>I am a returning customer</strong>
            <hr />
          </div>
          <!-- VALIDATE IF CUSTOMER EXISTS ##############################-->
          <form action="/login" method="POST">
            <div class="form-group">
              <label for="input-email" class="control-label">E-Mail Address</label>
              <input type="text" class="form-control" id="input-email" placeholder="E-Mail Address" name="email">
            </div>
            <div class="form-group">
              <label for="input-password" class="control-label">Password</label>
              <input type="password" class="form-control" id="input-password" placeholder="Password" name="password">
              <input id="input-qstr" type="hidden" name="hidden" value="">
              <br>
              <a>Forgot Password?</a>
            </div>
            <input type="submit" class="btn btn-primary" value="Login">
          </form>
        </div>
				<div id="errorsbox"></div>
      </div>
    </div>
  </div>
</body>
<footer></footer>